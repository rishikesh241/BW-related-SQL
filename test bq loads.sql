-- CREATE OR REPLACE TABLE `sap-iac-test.GS4_CDC.matdoc_bkp` AS (SELECT * FROM `sap-iac-test.GS4_CDC.matdoc`) 

--  Copyright 2021 Google Inc.

--  Licensed under the Apache License, Version 2.0 (the "License");
--  you may not use this file except in compliance with the License.
--  You may obtain a copy of the License at

--      http://www.apache.org/licenses/LICENSE-2.0

--  Unless required by applicable law or agreed to in writing, software
--  distributed under the License is distributed on an "AS IS" BASIS,
--  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
--  See the License for the specific language governing permissions and
--  limitations under the License.

MERGE `sap-iac-test.GS4_CDC.matdoc` AS T
USING (
  WITH
    -- All the rows that arrived in raw table after the latest CDC table refresh.
    NewRawRecords AS (
      SELECT * FROM `sap-iac-test.GS4_RAW.matdoc`
      WHERE recordstamp >= (
        SELECT IFNULL(MAX(recordstamp), TIMESTAMP('1940-12-25 05:30:00+00'))
        FROM `sap-iac-test.GS4_CDC.matdoc`)
      AND `KEY3` IS NOT NULL AND `KEY1` IS NOT NULL AND `KEY2` IS NOT NULL AND `KEY4` IS NOT NULL AND `KEY5` IS NOT NULL AND `KEY6` IS NOT NULL AND `MANDT` IS NOT NULL
    )
    -- For each unique record (by primary key), find chronologically latest row. This ensures CDC
    -- table only contains one entry for a unique record.
    -- This also handles the conditions where SLT connector may have introduced true duplicate
    -- rows (same recordstamp).
    SELECT *
    FROM NewRawRecords
    QUALIFY
      ROW_NUMBER() OVER (
        PARTITION BY KEY3, KEY1, KEY2, KEY4, KEY5, KEY6, MANDT
        ORDER BY
          recordstamp DESC,
          IF(operation_flag = 'D', 'ZZ', operation_flag) DESC -- Prioritize "D" flag within the dups.
      ) = 1
  ) AS S
ON T.`KEY3` = S.`KEY3` AND T.`KEY1` = S.`KEY1` AND T.`KEY2` = S.`KEY2` AND T.`KEY4` = S.`KEY4` AND T.`KEY5` = S.`KEY5` AND T.`KEY6` = S.`KEY6` AND T.`MANDT` = S.`MANDT`
-- ## CORTEX-CUSTOMER You can use "is_deleted = true" condition along with "operation_flag = 'D'",
-- if that is applicable to your CDC set up.
WHEN NOT MATCHED AND IFNULL(S.operation_flag, 'I') != 'D' THEN
  INSERT (`mandt`, `key1`, `key2`, `key3`, `key4`, `key5`, `key6`, `record_type`, `header_counter`, `matbf`, `werks`, `lgort_sid`, `charg_sid`, `lifnr_sid`, `mat_kdauf`, `mat_kdpos`, `mat_pspnr`, `kunnr_sid`, `sobkz`, `lbbsa_sid`, `disub_owner_sid`, `resourcename_sid`, `bukrs`, `charg_whs_sg`, `mengu`, `wertu`, `vbobj_sg`, `kzbws`, `bstaus_sg`, `bsttyp_sg`, `kalnr`, `berid`, `waers`, `dmbtr`, `bnbtr`, `bualt`, `dmbum`, `exbwr`, `vkwrt`, `exvkw`, `salk3`, `vkwra`, `j_1bexbase`, `stock_vkwrt`, `dmbtr_stock`, `dmbtr_cons`, `meins`, `menge`, `lbkum`, `stock_qty`, `consumption_qty`, `erfme`, `erfmg`, `bprme`, `bpmng`, `bstme`, `bstmg`, `lsmeh`, `lsmng`, `pbamg`, `currency_a1`, `price_a1`, `price_source_a1`, `stock_value_a1`, `cons_value_a1`, `cwm_menge`, `cwm_meins`, `cwm_erfmg`, `cwm_erfme`, `cwm_stock_qty`, `cwm_consumption_qty`, `cwm_meins_sid`, `ummab_cid`, `umwrk_cid`, `lgort_cid`, `charg_cid`, `lifnr_cid`, `mat_kdauf_cid`, `mat_kdpos_cid`, `mat_pspnr_cid`, `kunnr_cid`, `umsok_cid`, `lbbsa_cid`, `disub_owner_cid`, `resourcename_cid`, `umbuk_cg`, `charg_whs_cg`, `ummen_cg`, `umwer_cg`, `vbobj_cg`, `umkzbws_cg`, `bstaus_cg`, `bsttyp_cg`, `kalnr_cg`, `budat`, `cpudt`, `cputm`, `yearday_budat`, `yearweek_budat`, `yearmonth_budat`, `yearquarter_budat`, `year_budat`, `quarter_budat`, `month_budat`, `week_budat`, `day_budat`, `weekday_budat`, `bldat`, `aedat`, `spe_budat_uhr`, `spe_budat_zone`, `periv`, `gjahr`, `gjper`, `gjper_curr_per`, `vfdat`, `dabrbz`, `dabrz`, `hsdat`, `mblnr`, `mjahr`, `zeile`, `line_id`, `parent_id`, `line_depth`, `maa_urzei`, `kdauf`, `kdpos`, `kdein`, `ebeln`, `ebelp`, `lfbja`, `lfbnr`, `lfpos`, `sjahr`, `smbln`, `smblp`, `aufnr`, `anln1`, `anln2`, `belnr`, `buzei`, `belum`, `buzum`, `rsnum`, `rspos`, `tbnum`, `tbpos`, `ubnum`, `tanum`, `urzei`, `xblnr`, `vbeln_im`, `vbelp_im`, `le_vbeln`, `spe_logsys`, `spe_mdnum_ewm`, `cancelled`, `cancellation_type`, `reversal_movement`, `service_doc_type`, `service_doc_id`, `service_doc_item_id`, `ewm_lgnum`, `ewm_gmdoc`, `ewm_lgpla`, `xstor`, `bwart`, `xauto`, `matnr`, `lgort`, `charg`, `bwtar`, `insmk`, `zusch`, `zustd`, `lifnr`, `kunnr`, `plpla`, `shkzg`, `shkum`, `elikz`, `sgtxt`, `equnr`, `wempf`, `ablad`, `gsber`, `kokrs`, `pargb`, `parbu`, `kostl`, `projn`, `xskst`, `xsauf`, `xspro`, `xserg`, `xruem`, `xruej`, `kzear`, `kzstr`, `ummat`, `umcha`, `umlgo`, `umzst`, `umzus`, `kzbew`, `kzvbr`, `kzzug`, `weunb`, `palan`, `lgnum`, `lgtyp`, `lgpla`, `bestq`, `bwlvs`, `xblvs`, `vschn`, `nschn`, `dypla`, `tbpri`, `weanz`, `grund`, `evers`, `evere`, `imkey`, `kstrg`, `paobjnr`, `prctr`, `ps_psp_pnr`, `nplnr`, `aufpl`, `aplzl`, `aufps`, `vptnr`, `fipos`, `sakto`, `xwsbr`, `emlif`, `aktnr`, `zekkn`, `cuobj_ch`, `pprctr`, `rsart`, `geber`, `fistl`, `bustm`, `bustw`, `vprsv`, `fkber`, `xbeau`, `qinspst`, `mwskz`, `txjcd`, `ematn`, `j_1agirupd`, `vkmws`, `berkz`, `xwoff`, `bemot`, `prznr`, `llief`, `lstar`, `xobew`, `grant_nbr`, `zustd_t156m`, `spe_gts_stock_ty`, `kblnr`, `kblpos`, `xmacc`, `ummab`, `umbar`, `umwrk`, `umsok`, `sgt_scat`, `sgt_umscat`, `sgt_rcat`, `disub_owner`, `compl_mark`, `fzgls_mark`, `etanp_mark`, `popup_mark`, `xsaut`, `serviceperformer`, `pernr`, `knttp_gr`, `work_item_id`, `fbuda`, `dummy_incl_eew_cobl`, `fsh_season_year`, `fsh_season`, `fsh_collection`, `fsh_theme`, `wrf_charstc1`, `wrf_charstc2`, `wrf_charstc3`, `dummy_matdoc_incl_eew_ps`, `oinavnw`, `oicondcod`, `condi`, `ass_pspnr`, `blart`, `blaum`, `tcode`, `bktxt`, `frath`, `frbnr`, `wever`, `xabln`, `awsys`, `bla2d`, `bfwms`, `vgart`, `usnam`, `tcode2`, `exnum`, `gts_cusref_no`, `fls_rsto`, `msr_active`, `xcompl`, `knumv`, `dataaging`, `xprint`, `lmbmv`, `pabpm`, `xfmat`, `knbdr`, `recordstamp`)
  VALUES (`mandt`, `key1`, `key2`, `key3`, `key4`, `key5`, `key6`, `record_type`, `header_counter`, `matbf`, COALESCE(`werks`,""), `lgort_sid`, `charg_sid`, `lifnr_sid`, `mat_kdauf`, `mat_kdpos`, `mat_pspnr`, `kunnr_sid`, COALESCE(`sobkz`,""), `lbbsa_sid`, `disub_owner_sid`, `resourcename_sid`, COALESCE(`bukrs`,""), `charg_whs_sg`, `mengu`, `wertu`, `vbobj_sg`, `kzbws`, COALESCE(`bstaus_sg`,""), `bsttyp_sg`, `kalnr`, `berid`, COALESCE(`waers`,""), `dmbtr`, `bnbtr`, `bualt`, `dmbum`, `exbwr`, `vkwrt`, `exvkw`, `salk3`, `vkwra`, `j_1bexbase`, `stock_vkwrt`, `dmbtr_stock`, `dmbtr_cons`, COALESCE(`meins`,""), `menge`, `lbkum`, `stock_qty`, `consumption_qty`, `erfme`, `erfmg`, `bprme`, `bpmng`, `bstme`, `bstmg`, `lsmeh`, `lsmng`, `pbamg`, `currency_a1`, `price_a1`, `price_source_a1`, `stock_value_a1`, `cons_value_a1`, `cwm_menge`, `cwm_meins`, `cwm_erfmg`, `cwm_erfme`, `cwm_stock_qty`, `cwm_consumption_qty`, `cwm_meins_sid`, `ummab_cid`, `umwrk_cid`, `lgort_cid`, `charg_cid`, `lifnr_cid`, `mat_kdauf_cid`, `mat_kdpos_cid`, `mat_pspnr_cid`, `kunnr_cid`, `umsok_cid`, `lbbsa_cid`, `disub_owner_cid`, `resourcename_cid`, `umbuk_cg`, `charg_whs_cg`, `ummen_cg`, `umwer_cg`, `vbobj_cg`, `umkzbws_cg`, `bstaus_cg`, `bsttyp_cg`, `kalnr_cg`, `budat`, `cpudt`, `cputm`, `yearday_budat`, `yearweek_budat`, `yearmonth_budat`, `yearquarter_budat`, `year_budat`, `quarter_budat`, `month_budat`, `week_budat`, `day_budat`, `weekday_budat`, `bldat`, `aedat`, `spe_budat_uhr`, `spe_budat_zone`, `periv`, `gjahr`, `gjper`, `gjper_curr_per`, `vfdat`, `dabrbz`, `dabrz`, `hsdat`, `mblnr`, `mjahr`, `zeile`, `line_id`, `parent_id`, `line_depth`, `maa_urzei`, `kdauf`, `kdpos`, `kdein`, `ebeln`, `ebelp`, `lfbja`, `lfbnr`, `lfpos`, `sjahr`, `smbln`, `smblp`, `aufnr`, `anln1`, `anln2`, `belnr`, `buzei`, `belum`, `buzum`, `rsnum`, `rspos`, `tbnum`, `tbpos`, `ubnum`, `tanum`, `urzei`, `xblnr`, `vbeln_im`, `vbelp_im`, `le_vbeln`, `spe_logsys`, `spe_mdnum_ewm`, `cancelled`, `cancellation_type`, `reversal_movement`, `service_doc_type`, `service_doc_id`, `service_doc_item_id`, `ewm_lgnum`, `ewm_gmdoc`, `ewm_lgpla`, `xstor`, COALESCE(`bwart`,""), `xauto`, COALESCE(`matnr`,""), COALESCE(`lgort`,""), COALESCE(`charg`,""), `bwtar`, COALESCE(`insmk`,""), `zusch`, `zustd`, `lifnr`, `kunnr`, `plpla`, COALESCE(`shkzg`,""), `shkum`, `elikz`, `sgtxt`, `equnr`, `wempf`, `ablad`, `gsber`, `kokrs`, `pargb`, `parbu`, `kostl`, `projn`, `xskst`, `xsauf`, `xspro`, `xserg`, `xruem`, `xruej`, `kzear`, `kzstr`, `ummat`, `umcha`, `umlgo`, `umzst`, `umzus`, `kzbew`, `kzvbr`, `kzzug`, `weunb`, `palan`, `lgnum`, `lgtyp`, `lgpla`, `bestq`, `bwlvs`, `xblvs`, `vschn`, `nschn`, `dypla`, `tbpri`, `weanz`, `grund`, `evers`, `evere`, `imkey`, `kstrg`, `paobjnr`, `prctr`, `ps_psp_pnr`, `nplnr`, `aufpl`, `aplzl`, `aufps`, `vptnr`, `fipos`, `sakto`, `xwsbr`, `emlif`, `aktnr`, `zekkn`, `cuobj_ch`, `pprctr`, `rsart`, `geber`, `fistl`, `bustm`, `bustw`, `vprsv`, `fkber`, `xbeau`, `qinspst`, `mwskz`, `txjcd`, `ematn`, `j_1agirupd`, `vkmws`, `berkz`, `xwoff`, `bemot`, `prznr`, `llief`, `lstar`, `xobew`, `grant_nbr`, `zustd_t156m`, `spe_gts_stock_ty`, `kblnr`, `kblpos`, `xmacc`, `ummab`, `umbar`, `umwrk`, `umsok`, `sgt_scat`, `sgt_umscat`, `sgt_rcat`, `disub_owner`, `compl_mark`, `fzgls_mark`, `etanp_mark`, `popup_mark`, `xsaut`, `serviceperformer`, `pernr`, `knttp_gr`, `work_item_id`, `fbuda`, `dummy_incl_eew_cobl`, `fsh_season_year`, `fsh_season`, `fsh_collection`, `fsh_theme`, `wrf_charstc1`, `wrf_charstc2`, `wrf_charstc3`, `dummy_matdoc_incl_eew_ps`, `oinavnw`, `oicondcod`, `condi`, `ass_pspnr`, `blart`, `blaum`, `tcode`, `bktxt`, `frath`, `frbnr`, `wever`, `xabln`, `awsys`, `bla2d`, `bfwms`, `vgart`, `usnam`, `tcode2`, `exnum`, `gts_cusref_no`, `fls_rsto`, `msr_active`, `xcompl`, `knumv`, `dataaging`, `xprint`, `lmbmv`, `pabpm`, `xfmat`, `knbdr`, `recordstamp`)
WHEN MATCHED AND S.operation_flag = 'D' THEN
  DELETE
WHEN MATCHED AND S.operation_flag IN ('I','U') THEN
  UPDATE SET T.`mandt` = S.`mandt`, T.`key1` = S.`key1`, T.`key2` = S.`key2`, T.`key3` = S.`key3`, T.`key4` = S.`key4`, T.`key5` = S.`key5`, T.`key6` = S.`key6`, T.`record_type` = S.`record_type`, T.`header_counter` = S.`header_counter`, T.`matbf` = S.`matbf`, T.`werks` = COALESCE(S.`werks`,""), T.`lgort_sid` = S.`lgort_sid`, T.`charg_sid` = S.`charg_sid`, T.`lifnr_sid` = S.`lifnr_sid`, T.`mat_kdauf` = S.`mat_kdauf`, T.`mat_kdpos` = S.`mat_kdpos`, T.`mat_pspnr` = S.`mat_pspnr`, T.`kunnr_sid` = S.`kunnr_sid`, T.`sobkz` = COALESCE(S.`sobkz`,""), T.`lbbsa_sid` = S.`lbbsa_sid`, T.`disub_owner_sid` = S.`disub_owner_sid`, T.`resourcename_sid` = S.`resourcename_sid`, T.`bukrs` = coalesce(S.`bukrs`,""), T.`charg_whs_sg` = S.`charg_whs_sg`, T.`mengu` = S.`mengu`, T.`wertu` = S.`wertu`, T.`vbobj_sg` = S.`vbobj_sg`, T.`kzbws` = S.`kzbws`, T.`bstaus_sg` = coalesce(S.`bstaus_sg`,""), T.`bsttyp_sg` = S.`bsttyp_sg`, T.`kalnr` = S.`kalnr`, T.`berid` = S.`berid`, T.`waers` = coalesce(S.`waers`,""), T.`dmbtr` = S.`dmbtr`, T.`bnbtr` = S.`bnbtr`, T.`bualt` = S.`bualt`, T.`dmbum` = S.`dmbum`, T.`exbwr` = S.`exbwr`, T.`vkwrt` = S.`vkwrt`, T.`exvkw` = S.`exvkw`, T.`salk3` = S.`salk3`, T.`vkwra` = S.`vkwra`, T.`j_1bexbase` = S.`j_1bexbase`, T.`stock_vkwrt` = S.`stock_vkwrt`, T.`dmbtr_stock` = S.`dmbtr_stock`, T.`dmbtr_cons` = S.`dmbtr_cons`, T.`meins` = COALESCE(S.`meins`,""), T.`menge` = S.`menge`, T.`lbkum` = S.`lbkum`, T.`stock_qty` = S.`stock_qty`, T.`consumption_qty` = S.`consumption_qty`, T.`erfme` = S.`erfme`, T.`erfmg` = S.`erfmg`, T.`bprme` = S.`bprme`, T.`bpmng` = S.`bpmng`, T.`bstme` = S.`bstme`, T.`bstmg` = S.`bstmg`, T.`lsmeh` = S.`lsmeh`, T.`lsmng` = S.`lsmng`, T.`pbamg` = S.`pbamg`, T.`currency_a1` = S.`currency_a1`, T.`price_a1` = S.`price_a1`, T.`price_source_a1` = S.`price_source_a1`, T.`stock_value_a1` = S.`stock_value_a1`, T.`cons_value_a1` = S.`cons_value_a1`, T.`cwm_menge` = S.`cwm_menge`, T.`cwm_meins` = S.`cwm_meins`, T.`cwm_erfmg` = S.`cwm_erfmg`, T.`cwm_erfme` = S.`cwm_erfme`, T.`cwm_stock_qty` = S.`cwm_stock_qty`, T.`cwm_consumption_qty` = S.`cwm_consumption_qty`, T.`cwm_meins_sid` = S.`cwm_meins_sid`, T.`ummab_cid` = S.`ummab_cid`, T.`umwrk_cid` = S.`umwrk_cid`, T.`lgort_cid` = S.`lgort_cid`, T.`charg_cid` = S.`charg_cid`, T.`lifnr_cid` = S.`lifnr_cid`, T.`mat_kdauf_cid` = S.`mat_kdauf_cid`, T.`mat_kdpos_cid` = S.`mat_kdpos_cid`, T.`mat_pspnr_cid` = S.`mat_pspnr_cid`, T.`kunnr_cid` = S.`kunnr_cid`, T.`umsok_cid` = S.`umsok_cid`, T.`lbbsa_cid` = S.`lbbsa_cid`, T.`disub_owner_cid` = S.`disub_owner_cid`, T.`resourcename_cid` = S.`resourcename_cid`, T.`umbuk_cg` = S.`umbuk_cg`, T.`charg_whs_cg` = S.`charg_whs_cg`, T.`ummen_cg` = S.`ummen_cg`, T.`umwer_cg` = S.`umwer_cg`, T.`vbobj_cg` = S.`vbobj_cg`, T.`umkzbws_cg` = S.`umkzbws_cg`, T.`bstaus_cg` = S.`bstaus_cg`, T.`bsttyp_cg` = S.`bsttyp_cg`, T.`kalnr_cg` = S.`kalnr_cg`, T.`budat` = S.`budat`, T.`cpudt` = S.`cpudt`, T.`cputm` = S.`cputm`, T.`yearday_budat` = S.`yearday_budat`, T.`yearweek_budat` = S.`yearweek_budat`, T.`yearmonth_budat` = S.`yearmonth_budat`, T.`yearquarter_budat` = S.`yearquarter_budat`, T.`year_budat` = S.`year_budat`, T.`quarter_budat` = S.`quarter_budat`, T.`month_budat` = S.`month_budat`, T.`week_budat` = S.`week_budat`, T.`day_budat` = S.`day_budat`, T.`weekday_budat` = S.`weekday_budat`, T.`bldat` = S.`bldat`, T.`aedat` = S.`aedat`, T.`spe_budat_uhr` = S.`spe_budat_uhr`, T.`spe_budat_zone` = S.`spe_budat_zone`, T.`periv` = S.`periv`, T.`gjahr` = S.`gjahr`, T.`gjper` = S.`gjper`, T.`gjper_curr_per` = S.`gjper_curr_per`, T.`vfdat` = S.`vfdat`, T.`dabrbz` = S.`dabrbz`, T.`dabrz` = S.`dabrz`, T.`hsdat` = S.`hsdat`, T.`mblnr` = S.`mblnr`, T.`mjahr` = S.`mjahr`, T.`zeile` = S.`zeile`, T.`line_id` = S.`line_id`, T.`parent_id` = S.`parent_id`, T.`line_depth` = S.`line_depth`, T.`maa_urzei` = S.`maa_urzei`, T.`kdauf` = S.`kdauf`, T.`kdpos` = S.`kdpos`, T.`kdein` = S.`kdein`, T.`ebeln` = S.`ebeln`, T.`ebelp` = S.`ebelp`, T.`lfbja` = S.`lfbja`, T.`lfbnr` = S.`lfbnr`, T.`lfpos` = S.`lfpos`, T.`sjahr` = S.`sjahr`, T.`smbln` = S.`smbln`, T.`smblp` = S.`smblp`, T.`aufnr` = S.`aufnr`, T.`anln1` = S.`anln1`, T.`anln2` = S.`anln2`, T.`belnr` = S.`belnr`, T.`buzei` = S.`buzei`, T.`belum` = S.`belum`, T.`buzum` = S.`buzum`, T.`rsnum` = S.`rsnum`, T.`rspos` = S.`rspos`, T.`tbnum` = S.`tbnum`, T.`tbpos` = S.`tbpos`, T.`ubnum` = S.`ubnum`, T.`tanum` = S.`tanum`, T.`urzei` = S.`urzei`, T.`xblnr` = S.`xblnr`, T.`vbeln_im` = S.`vbeln_im`, T.`vbelp_im` = S.`vbelp_im`, T.`le_vbeln` = S.`le_vbeln`, T.`spe_logsys` = S.`spe_logsys`, T.`spe_mdnum_ewm` = S.`spe_mdnum_ewm`, T.`cancelled` = S.`cancelled`, T.`cancellation_type` = S.`cancellation_type`, T.`reversal_movement` = S.`reversal_movement`, T.`service_doc_type` = S.`service_doc_type`, T.`service_doc_id` = S.`service_doc_id`, T.`service_doc_item_id` = S.`service_doc_item_id`, T.`ewm_lgnum` = S.`ewm_lgnum`, T.`ewm_gmdoc` = S.`ewm_gmdoc`, T.`ewm_lgpla` = S.`ewm_lgpla`, T.`xstor` = S.`xstor`, T.`bwart` = COALESCE(S.`bwart`,""), T.`xauto` = S.`xauto`, T.`matnr` = COALESCE(S.`matnr`,"X"), T.`lgort` = COALESCE(S.`lgort`,""), T.`charg` = COALESCE(S.`charg`,""), T.`bwtar` = S.`bwtar`, T.`insmk` = coalesce(S.`insmk`,""), T.`zusch` = S.`zusch`, T.`zustd` = S.`zustd`, T.`lifnr` = S.`lifnr`, T.`kunnr` = S.`kunnr`, T.`plpla` = S.`plpla`, T.`shkzg` = COALESCE(S.`shkzg`,""), T.`shkum` = S.`shkum`, T.`elikz` = S.`elikz`, T.`sgtxt` = S.`sgtxt`, T.`equnr` = S.`equnr`, T.`wempf` = S.`wempf`, T.`ablad` = S.`ablad`, T.`gsber` = S.`gsber`, T.`kokrs` = S.`kokrs`, T.`pargb` = S.`pargb`, T.`parbu` = S.`parbu`, T.`kostl` = S.`kostl`, T.`projn` = S.`projn`, T.`xskst` = S.`xskst`, T.`xsauf` = S.`xsauf`, T.`xspro` = S.`xspro`, T.`xserg` = S.`xserg`, T.`xruem` = S.`xruem`, T.`xruej` = S.`xruej`, T.`kzear` = S.`kzear`, T.`kzstr` = S.`kzstr`, T.`ummat` = S.`ummat`, T.`umcha` = S.`umcha`, T.`umlgo` = S.`umlgo`, T.`umzst` = S.`umzst`, T.`umzus` = S.`umzus`, T.`kzbew` = S.`kzbew`, T.`kzvbr` = S.`kzvbr`, T.`kzzug` = S.`kzzug`, T.`weunb` = S.`weunb`, T.`palan` = S.`palan`, T.`lgnum` = S.`lgnum`, T.`lgtyp` = S.`lgtyp`, T.`lgpla` = S.`lgpla`, T.`bestq` = S.`bestq`, T.`bwlvs` = S.`bwlvs`, T.`xblvs` = S.`xblvs`, T.`vschn` = S.`vschn`, T.`nschn` = S.`nschn`, T.`dypla` = S.`dypla`, T.`tbpri` = S.`tbpri`, T.`weanz` = S.`weanz`, T.`grund` = S.`grund`, T.`evers` = S.`evers`, T.`evere` = S.`evere`, T.`imkey` = S.`imkey`, T.`kstrg` = S.`kstrg`, T.`paobjnr` = S.`paobjnr`, T.`prctr` = S.`prctr`, T.`ps_psp_pnr` = S.`ps_psp_pnr`, T.`nplnr` = S.`nplnr`, T.`aufpl` = S.`aufpl`, T.`aplzl` = S.`aplzl`, T.`aufps` = S.`aufps`, T.`vptnr` = S.`vptnr`, T.`fipos` = S.`fipos`, T.`sakto` = S.`sakto`, T.`xwsbr` = S.`xwsbr`, T.`emlif` = S.`emlif`, T.`aktnr` = S.`aktnr`, T.`zekkn` = S.`zekkn`, T.`cuobj_ch` = S.`cuobj_ch`, T.`pprctr` = S.`pprctr`, T.`rsart` = S.`rsart`, T.`geber` = S.`geber`, T.`fistl` = S.`fistl`, T.`bustm` = S.`bustm`, T.`bustw` = S.`bustw`, T.`vprsv` = S.`vprsv`, T.`fkber` = S.`fkber`, T.`xbeau` = S.`xbeau`, T.`qinspst` = S.`qinspst`, T.`mwskz` = S.`mwskz`, T.`txjcd` = S.`txjcd`, T.`ematn` = S.`ematn`, T.`j_1agirupd` = S.`j_1agirupd`, T.`vkmws` = S.`vkmws`, T.`berkz` = S.`berkz`, T.`xwoff` = S.`xwoff`, T.`bemot` = S.`bemot`, T.`prznr` = S.`prznr`, T.`llief` = S.`llief`, T.`lstar` = S.`lstar`, T.`xobew` = S.`xobew`, T.`grant_nbr` = S.`grant_nbr`, T.`zustd_t156m` = S.`zustd_t156m`, T.`spe_gts_stock_ty` = S.`spe_gts_stock_ty`, T.`kblnr` = S.`kblnr`, T.`kblpos` = S.`kblpos`, T.`xmacc` = S.`xmacc`, T.`ummab` = S.`ummab`, T.`umbar` = S.`umbar`, T.`umwrk` = S.`umwrk`, T.`umsok` = S.`umsok`, T.`sgt_scat` = S.`sgt_scat`, T.`sgt_umscat` = S.`sgt_umscat`, T.`sgt_rcat` = S.`sgt_rcat`, T.`disub_owner` = S.`disub_owner`, T.`compl_mark` = S.`compl_mark`, T.`fzgls_mark` = S.`fzgls_mark`, T.`etanp_mark` = S.`etanp_mark`, T.`popup_mark` = S.`popup_mark`, T.`xsaut` = S.`xsaut`, T.`serviceperformer` = S.`serviceperformer`, T.`pernr` = S.`pernr`, T.`knttp_gr` = S.`knttp_gr`, T.`work_item_id` = S.`work_item_id`, T.`fbuda` = S.`fbuda`, T.`dummy_incl_eew_cobl` = S.`dummy_incl_eew_cobl`, T.`fsh_season_year` = S.`fsh_season_year`, T.`fsh_season` = S.`fsh_season`, T.`fsh_collection` = S.`fsh_collection`, T.`fsh_theme` = S.`fsh_theme`, T.`wrf_charstc1` = S.`wrf_charstc1`, T.`wrf_charstc2` = S.`wrf_charstc2`, T.`wrf_charstc3` = S.`wrf_charstc3`, T.`dummy_matdoc_incl_eew_ps` = S.`dummy_matdoc_incl_eew_ps`, T.`oinavnw` = S.`oinavnw`, T.`oicondcod` = S.`oicondcod`, T.`condi` = S.`condi`, T.`ass_pspnr` = S.`ass_pspnr`, T.`blart` = S.`blart`, T.`blaum` = S.`blaum`, T.`tcode` = S.`tcode`, T.`bktxt` = S.`bktxt`, T.`frath` = S.`frath`, T.`frbnr` = S.`frbnr`, T.`wever` = S.`wever`, T.`xabln` = S.`xabln`, T.`awsys` = S.`awsys`, T.`bla2d` = S.`bla2d`, T.`bfwms` = S.`bfwms`, T.`vgart` = S.`vgart`, T.`usnam` = S.`usnam`, T.`tcode2` = S.`tcode2`, T.`exnum` = S.`exnum`, T.`gts_cusref_no` = S.`gts_cusref_no`, T.`fls_rsto` = S.`fls_rsto`, T.`msr_active` = S.`msr_active`, T.`xcompl` = S.`xcompl`, T.`knumv` = S.`knumv`, T.`dataaging` = S.`dataaging`, T.`xprint` = S.`xprint`, T.`lmbmv` = S.`lmbmv`, T.`pabpm` = S.`pabpm`, T.`xfmat` = S.`xfmat`, T.`knbdr` = S.`knbdr`, T.`recordstamp` = S.`recordstamp`;

